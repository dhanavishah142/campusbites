<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Register | Campus Bites</title>
  <link rel="icon" href="img/core-img/campus-bites.jpg">
  <link href="style.css" rel="stylesheet">
  <link href="css/responsive/responsive.css" rel="stylesheet">
  <style>
    #register .card {
      background-color: #fff;
      border-radius: 15px;
      transition: 0.3s;
    }
    #register .card:hover {
      transform: scale(1.02);
    }
    #register input.form-control,
    #register select.form-select {
      border-radius: 10px;
    }
    #register button.btn {
      border-radius: 10px;
      transition: 0.3s;
      background-color: #d62300;
      color: #fff;
    }
    #register button.btn:hover {
      background-color: #b91e00;
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
  <header class="header_area">
    <div class="container">
      <div class="logo_area text-center" style="display: flex; align-items: center; justify-content: center; gap: 15px;">
        <img src="img/bg-img/canteen review logo (white).jpg" alt="logo" style="height: 90px;">
        <a href="index.html" class="yummy-logo" style="font-size: 46px; text-decoration: none; color: #000;">Campus Bites</a>
      </div>
    </div>
  </header>

  <section id="register" class="d-flex align-items-center justify-content-center" style="min-height: 80vh; background: #fff8f3;">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-5 col-md-7">
          <div class="card shadow-lg border-0 rounded-4">
            <div class="card-body p-4">
              <p class="text-center text-muted mb-4">Create your Campus Bites account</p>
              
              <form id="signup-form">
                <div class="form-group mb-3">
                  <label for="fullname">Full Name</label>
                  <input type="text" name="fullname" class="form-control" placeholder="Name-Surname" required>
                </div>

                <div class="form-group mb-3">
                  <label for="email">University Email</label>
                  <input type="email" name="email" class="form-control" placeholder="yourname@university.edu" required>
                </div>

                <div class="form-group mb-3">
                  <label for="role">I am a</label>
                  <select class="form-select" name="role" required>
                    <option value="" disabled selected>Select your role</option>
                    <option value="student">Student</option>
                    <option value="faculty">Faculty</option>
                  </select>
                </div>

                <!-- Always visible Branch field -->
                <div class="form-group mb-3">
                  <label for="branch">Branch</label>
                  <select class="form-select" name="branch" required>
                    <option value="" disabled selected>Select your branch</option>
                    <option value="MPSTME">NMIMS MPSTME</option>
                    <option value="NM">NM</option>
                    <option value="Late MPSTME">Late MPSTME</option>
                  </select>
                </div>

                <div class="form-group mb-3" style="position: relative;">
                  <label for="password">Password</label>
                  <input type="password" name="password" class="form-control" id="password" placeholder="Enter your password" required>
                  <i class="fa fa-eye" id="togglePassword" style="position: absolute; right: 15px; top: 38px; cursor: pointer; color: #d62300;"></i>
                </div>

                <div class="form-group mb-3" style="position: relative;">
                  <label for="confirmPassword">Confirm Password</label>
                  <input type="password" name="confirmPassword" class="form-control" id="confirmPassword" placeholder="Re-enter your password" required>
                  <i class="fa fa-eye" id="toggleConfirmPassword" style="position: absolute; right: 15px; top: 38px; cursor: pointer; color: #d62300;"></i>
                </div>
                <button type="submit" class="btn w-100">Sign Up</button>
              </form>

              <p class="text-center mt-4 mb-0">
                Already have an account?
                <a href="login.html" class="text-danger fw-semibold">Login here</a>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer id="footer" class="footer mt-auto py-3" style="background-color:#fff0ea;">
    <div class="container text-center">
      <p class="mb-0">&copy; 2025 <strong><span>Campus Bites</span></strong>. All Rights Reserved</p>
      <p class="mt-1 small" style="color:#d62300;">Made with ‚ù§Ô∏è for campus foodies</p>
    </div>
  </footer>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, updateProfile } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBy5yfr3yYuMSDFHWwp0LdRhQASe2EKx78",
    authDomain: "campusbites-a7d47.firebaseapp.com",
    projectId: "campusbites-a7d47",
    storageBucket: "campusbites-a7d47.appspot.com",
    messagingSenderId: "287799383807",
    appId: "1:287799383807:web:80dcc43f75b5e226241eca"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const signupForm = document.getElementById('signup-form');

  signupForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const fullName = signupForm.fullname.value.trim();
    const email = signupForm.email.value.trim().toLowerCase();
    const role = signupForm.role.value;
    const branch = signupForm.branch.value;
    const password = signupForm.password.value;
    const confirmPassword = signupForm.confirmPassword.value;

    const validDomains = ["nmims.in", "nmims.edu.in"];
    const emailDomain = email.split("@")[1];

    if (!validDomains.includes(emailDomain)) {
      Swal.fire({
        icon: "error",
        title: "Invalid Email",
        text: "Only NMIMS email addresses are allowed.",
      });
      return;
    }

    if (password !== confirmPassword) {
      Swal.fire({
        icon: "warning",
        title: "Password Mismatch",
        text: "Passwords do not match. Please try again!",
      });
      return;
    }

    try {
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;

      await updateProfile(user, { displayName: fullName });

      await setDoc(doc(db, "users", user.uid), {
        name: fullName,
        email: email,
        role: role,
        branch: branch,
        reviewCount: 0,
        createdAt: new Date()
      });

      Swal.fire({
        icon: "success",
        title: "Account Created!",
        text: "Your Campus Bites account has been created successfully üéâ",
        confirmButtonText: "Go to Home",
      }).then(() => {
        window.location.href = "index.html";
      });

    } catch (error) {
      console.error("Error:", error);
      Swal.fire({
        icon: "error",
        title: "Registration Failed",
        text: error.message,
      });
    }
  });
</script>
<script>
  // Toggle for main password field
  const togglePassword = document.querySelector("#togglePassword");
  const password = document.querySelector("#password");

  if (togglePassword && password) {
    togglePassword.addEventListener("click", function () {
      const type = password.getAttribute("type") === "password" ? "text" : "password";
      password.setAttribute("type", type);
      this.classList.toggle("fa-eye-slash");
    });
  }

  // Toggle for confirm password field (if exists)
  const toggleConfirmPassword = document.querySelector("#toggleConfirmPassword");
  const confirmPassword = document.querySelector("#confirmPassword");

  if (toggleConfirmPassword && confirmPassword) {
    toggleConfirmPassword.addEventListener("click", function () {
      const type = confirmPassword.getAttribute("type") === "password" ? "text" : "password";
      confirmPassword.setAttribute("type", type);
      this.classList.toggle("fa-eye-slash");
    });
  }
</script>
</body>
</html>



